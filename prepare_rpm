#!/bin/bash
. ../devrc
NAME=cluster-backbone
rpmd=/usr/src/packages

bin_files="cmc.py install_openpbs_mom.sh install_pbspro_mom.sh batchsys.sh_client make_image make_part_info populate_ramdisk.sh updatepwd.sh insert_package_info.py mysql_session.sh mysql_dump.sh populate_all_ramdisks.sh create_hopcount_tables.py old_config_to_new.py old_devlog_to_new.py dump_config.sh load_config.sh add_cluster_users.sh resync_config.sh tar_server.sh verify_packages.sh check_config.py compare_config.sh check_cluster.sh clog.py part_disc.py stop_cluster.sh start_cluster.sh start_server.sh stop_server.sh check_server.sh check_server_type.py py_resolv.py populate_ramdisk.py check_tables disable_server.sh disable_cluster.sh"
etc_files="mysql.cf all_files all_rpms"
scripts_files="*.sql renew_database.sh check_database.sh"
lcs_files="stage1 stage2 stage3"
init_scripts_files="openpbs_mom pbspro_mom pbs_server"
src_files="kcompile"
conf_files="syslog-ng.conf inetd.conf"
files="README LICENSE.GPL"
for f in $bin_files ; do files="$files cluster/bin/$f" ; done
for f in $etc_files ; do files="$files cluster/etc/$f" ; done
for f in $scripts_files ; do files="$files cluster/sql/$f" ; done
for f in $lcs_files ; do files="$files cluster/lcs/$f" ; done
for f in $init_scripts_files ; do files="$files cluster/init_scripts/$f" ; done
for f in $src_files ; do files="$files src/$f" ; done
for f in $conf_files ; do files="$files cluster/conf/$f" ; done
tar -hczvf ${rpmd}/SOURCES/${NAME}.tgz  $files

prepare_spec
cd $rpmd/SPECS
build_rpm noarch
install_file
