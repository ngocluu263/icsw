{% extends "main.html" %}

{% load i18n coffeescript %}

{% block title %}{% trans "License Overview" %}{% endblock %}

{% block angular %}{% include "angular/rms.cs" %}{% endblock %}

{% block content %}

{% verbatim %}


<h2>License Overview</h2>
<div id="icsw.rms">
    <div ng-controller="lic_ctrl">


<div class="container-fluid">
    <div class="row">

        <div class="col-md-2">
        
            <div class="panel panel-default">

                <div class="panel-heading">
                    <h4>Time range</h4>
                </div>

                <div class="panel-body">

                    <p>
                        <button type="button" ng-class="multi_view && 'btn btn-small btn-warning' || 'btn btn-small'" ng-click="multi_view = !multi_view">Multi view</button>
                    </p>

                    <div ng-show="!multi_view"> <!-- this must not be an ng-if, otherwise data binding breaks -->

                        <div class="form-group" style="margin-bottom: 0px">
                            <div class="input-group">
                                <input type="text" class="form-control" ng-model="licdaterangestart"></input>
                                <span class="dropdown-toggle input-group-addon">
                                    <div class="dropdown">
                                         <button class="btn dropdown-toggle btn-xs">
                                         <i class="glyphicon glyphicon-calendar"></i>
                                         </button>
                                         <ul class="dropdown-menu" role="menu">
                                             <datetimepicker ng-model="licdaterangestart"
                                                 data-datetimepicker-config="{ startView:'day', minView:'day' }" />
                                         </ul>
                                    </div>
                                </span>
                            </div>
                            <div class="input-group-btn">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-xs btn-primary dropdown-toggle" data-toggle="dropdown">
                                        <span class="glyphicon glyphicon-time"></span>
                                        {{timerange}} <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li ng-click="set_timerange('day')"><a href="#">day</a></li>
                                        <li ng-click="set_timerange('week')"><a href="#">week</a></li>
                                        <li ng-click="set_timerange('month')"><a href="#">month</a></li>
                                        <li ng-click="set_timerange('year')"><a href="#">year</a></li>
                                        <!-- values parsed by rest_views.py -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <h3>Available licenses</h3>
            <ul>
                <li ng-repeat="li in ext_license_list">
                    <input type="button" ng-class="get_li_sel_class(li)" ng-click="toggle_li_sel(li)" value="sel">
                    <!-- <input type="checkbox" id="cb_{{li.idx}}" ng-model="li.selected" ng-change="license_select_change()"> -->
                    <label for="cb_{{li.idx}}">{{li.name}}</label>
                    </input>
                </li>
            </ul>
        </div>

        <div class="col-md-10">
            <div class="row" ng-repeat="li in ext_license_selected">
                <div ng-if="!multi_view">
                    <div class="well well-sm" style="width:550px">
                        <h3>{{li.name}}</h3>
                        <licgraph lic="{{li.idx}}" dimpleloaded="dimpleloaded" timerange="timerange" licdaterangestart="licdaterangestart"></licgraph>
                    </div>
                </div>
                <div ng-if="multi_view">
                    <div class="well well-sm" style="width:1550px">
                        <h3>{{li.name}}</h3>
                        <table><tr> <!-- force single (overlong) line 
                            <td>
                                <licgraph lic="{{li.idx}}" dimpleloaded="dimpleloaded" fixedtimerange="year"  fixedlicdaterangestart="{{cur_time}}"></licgraph>
                            </td>
                            <td>
                                <licgraph lic="{{li.idx}}" dimpleloaded="dimpleloaded" fixedtimerange="month" fixedlicdaterangestart="{{cur_time}}"></licgraph>
                            </td>
                            <td>
                                <licgraph lic="{{li.idx}}" dimpleloaded="dimpleloaded" fixedtimerange="day"   fixedlicdaterangestart="{{cur_time}}"></licgraph>
                            </td>
                        </tr></table>
                    </div>
                 <div>
             </div>
        </div>
    </div>
</div>

            
    </div>
</div>

{% endverbatim %}

 <script type="text/javascript">

{% inlinecoffeescript %}

angular.element(document).ready(() ->
    angular.bootstrap($("div[id='icsw.rms']"), ["icsw.rms"])
)

{% endinlinecoffeescript %}

</script>

{% endblock %}

