
<script type="text/ng-template" id="icsw.monitoring.device">

    <icsw-tools-rest-table target-list="entries" config-service="icswMonitoringDeviceService"
                           st-table="entries_displayed" st-safe-src="entries" icsw-tools-table-leak-filtered="entries_filtered">
        <h2>Devices ({{ entries_filtered.length }} entries)</h2>
        <h3 ng-show="entries.length == 0">Please select devices in the tree to the left.</h3>
        <table
               class="table table-condensed table-hover" style="width:auto;">
            <thead>
                <tr>
                    <td colspan="99">
                        <input st-search="" class="form-control" placeholder="filter ..." type="text"/>
                    </td>
                </tr>
                <tr>
                    <td colspan="99">
                        <div icsw-tools-pagination st-items-by-page="10" st-displayed-pages="11"
                             possible-items-by-page="10,20,50,100,200,500,1000"></div>
                    </td>
                </tr>
                <tr>
                    <th st-sort="full_name" st-sort-default="true">Name</th>
                    <th st-sort="monitor_checks">Checks</th>
                    <th st-sort="mon_resolve_name">Resolve</th>
                    <th st-sort="mon_device_templ">Template</th>
                    <th st-sort="md_cache_mode">Cache mode</th>
                    <th st-sort="act_partition_table">Disk layout</th>
                    <th st-sort="mon_ext_host">Image</th>
                    <th st-sort="enable_perfdata">PerfData</th>
                    <th st-sort="flap_detection_enabled">Flap</th>
                    <th st-sort="automap_root_nagvis">NVroot</th>
                    <th st-sort="nagvis_parent">NVparent</th>
                    <th st-sort="monitor_server">MonServer</th>
                    <th colspan="1" class="text-center">Action</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="obj in entries_displayed">
                    <td>{{ obj.full_name }}</td>
                    <td>{{ obj.monitor_checks | yesno1 }}</td>
                    <td>{{ obj.mon_resolve_name | yesno2 }}</td>
                    <td>{{ obj.mon_device_templ | array_lookup:config_service.mon_device_templ:"name" }}</td>
                    <td>{{ obj.md_cache_mode | array_lookup:config_service.md_cache_modes:"name" }}</td>
                    <td>{{ obj.act_partition_table | yesno1 }}</td>
                    <td class="text-center">
        <span ng-if="obj.mon_ext_host">
            <img ng-src="{{ obj.mon_ext_host | array_lookup:config_service.mon_ext_host:'data_image' }}" width="24px"
                 height="24px"></img>
        </span>
        <span ng-if="obj.mon_ext_host == null">
            ---
        </span>
                    </td>
                    <td>{{ obj.enable_perfdata | yesno1 }}</td>
                    <td>{{ obj.flap_detection_enabled | yesno1 }}</td>
                    <td>{{ obj.automap_root_nagvis | yesno1 }}</td>
                    <td>{{ obj.nagvis_parent | array_lookup:entries:"name" }}</td>
                    <td>{{ obj.monitor_server | array_lookup:config_service.mon_server:"full_name":"Master" }}</td>
                    <td>
                        <icsw-tools-button type="modify" size="xs" ng-click="edit($event, obj)" value="modify"/>
                    </td>
                </tr>
            </tbody>
        </table>
    </icsw-tools-rest-table>

</script>


<script type="text/ng-template" id="device.monitoring.form">
    <form id="form" class="form-horizontal" ng-submit="modify()" name="form">
        <h2>Monitoring settings for {{ edit_obj.full_name }}</h2>
        <fieldset>
            <legend>Basic settings</legend>
            <div class="form-group">
                <label class="control-label col-sm-3 requiredField">
                    Md cache mode<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-7">
                    <ui-select ng-model="edit_obj.md_cache_mode" style="max-width:400px; min-width:240px;" ng-disabled="false">
                        <ui-select-match class="ui-select-match" placeholder="please select a cache mode">{{ $select.selected.name }}</ui-select-match>
                        <ui-select-choices class="ui-select-choices" repeat="value.idx as value in config_service.md_cache_modes| props_filter:{name:$select.search}">
                            <div ng-bind-html="value.name | highlight: $select.search"></div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3">
                    Mon device templ
                </label>
                <div class="controls col-sm-7">
                    <div class="input-group" style="max-width:400px; min-width:240px;">
                        <ui-select ng-model="edit_obj.mon_device_templ" ng-disabled="false">
                            <ui-select-match class="ui-select-match" placeholder="please select a device template">{{ $select.selected.name }}</ui-select-match>
                            <ui-select-choices class="ui-select-choices" repeat="value.idx as value in config_service.mon_device_templ| props_filter:{name:$select.search}">
                                <div ng-bind-html="value.name | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                        <span class="input-group-btn">
                            <button type="button" ng-click="edit_obj.mon_device_templ = undefined" class="btn btn-default">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3">
                    Mon ext host
                </label>
                <div class="controls col-sm-7">
                    <div class="input-group" style="max-width:400px; min-width:240px;">
                        <ui-select ng-model="edit_obj.mon_ext_host" ng-disabled="false">
                            <ui-select-match class="ui-select-match" placeholder="please select an icon">{{ $select.selected.name }}</ui-select-match>
                            <ui-select-choices class="ui-select-choices" repeat="value.idx as value in config_service.mon_ext_host| props_filter:{name:$select.search}">
                                <img ng-src="{{ value.data_image }}"></img>
                                <span ng-bind-html="value.name | highlight:$select.search">

                                </span></ui-select-choices>
                        </ui-select>
                        <span class="input-group-btn">
                            <button type="button" ng-click="edit_obj.mon_ext_host = undefined" class="btn btn-default">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3">
                    Monitor server
                </label>
                <div class="controls col-sm-7">
                    <div class="input-group" style="max-width:400px; min-width:240px;">
                        <ui-select ng-model="edit_obj.monitor_server" ng-disabled="false">
                            <ui-select-match class="ui-select-match" placeholder="please select a monitoring server">{{ $select.selected.name }}</ui-select-match>
                            <ui-select-choices class="ui-select-choices" repeat="value.idx as value in config_service.mon_server| props_filter:{name:$select.search}">
                                <div ng-bind-html="value.name | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                        <span class="input-group-btn">
                            <button type="button" ng-click="edit_obj.monitor_server = undefined" class="btn btn-default">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
        </fieldset>
        <fieldset>
            <legend>Flags</legend>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-7">
                                <label>
                                    <input checked="checked" class="checkboxinput checkbox" name="enable_perfdata" ng-model="edit_obj.enable_perfdata" type="checkbox"/>
                                    Enable perfdata, check IPMI and SNMP
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-7">
                                <label>
                                    <input checked="checked" class="checkboxinput checkbox" name="flap_detection_enabled" ng-model="edit_obj.flap_detection_enabled" type="checkbox"/>
                                    Flap detection enabled
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-7">
                                <label>
                                    <input checked="checked" class="checkboxinput checkbox" name="monitor_checks" ng-model="edit_obj.monitor_checks" type="checkbox"/>
                                    Checks enabled
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-7">
                                <label>
                                    <input checked="checked" class="checkboxinput checkbox" name="mon_resolve_name" ng-model="edit_obj.mon_resolve_name" type="checkbox"/>
                                    Resolve to IP for monitoring
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>
        <fieldset>
            <legend>NagVis settings</legend>
            <div class="form-group">
                <div class="checkbox">
                    <div class="controls col-lg-offset-0 col-sm-7">
                        <label>
                            <input class="checkboxinput checkbox" name="automap_root_nagvis" ng-model="edit_obj.automap_root_nagvis" type="checkbox"/>
                            Automap root nagvis
                        </label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3">
                    Nagvis parent
                </label>
                <div class="controls col-sm-7">
                    <div class="input-group" style="max-width:400px; min-width:240px;">
                        <ui-select ng-model="edit_obj.nagvis_parent" ng-disabled="false">
                            <ui-select-match class="ui-select-match" placeholder="select a nagvis parent">{{ $select.selected.name }}</ui-select-match>
                            <ui-select-choices class="ui-select-choices" repeat="value.idx as value in entries | orderBy:'name'| props_filter:{name:$select.search, automap_root_nagvis:true}">
                                <div ng-bind-html="value.name | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                        <span class="input-group-btn">
                            <button type="button" ng-click="edit_obj.nagvis_parent = undefined" class="btn btn-default">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
        </fieldset>
        <div class="form-actions">
            <input type="submit" name="submit" value="" class="btn btn-primary primaryAction" id="submit-id-submit" ng-value="get_action_string()"></input> <input type="button" name="fetch" value="Fetch disk layout" class="btn btn-warning" id="button-id-fetch" ng-click="config_service.fetch(this.edit_obj)"/>
        </div>
    </form>
</script>
