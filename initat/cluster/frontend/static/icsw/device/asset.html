<script type="text/ng-template" id="icsw/device/asset/overview">
    <icsw-device-asset-overview icsw-sel-man="0"></icsw-device-asset-overview>
</script>

<script type="text/ng-template" id="icsw.device.asset.overview">
    <uib-alert type="warning" ng-show="!struct.data_loaded">Fetching data from server ...</uib-alert>
    <icsw-tools-ensure-device-selection dev-list="struct.devices" list-ready="struct.data_loaded">

        <h2>
            <span>Assets (length): {{ $root.assets.length }}</span>
        </h2>




        <table
            class="table table-condensed table-hover table-bordered"
            style="width:auto;"
            ng-show="$root.assets_sf.length > 0"
            st-table="$root.assets"
            st-safe-src="$root.assets_sf"
        >
            <tbody>
                <tr>
                    <th>
                        <button ng-if="$root.expanded" ng-click="$root.expanded = false">-</button>
                        <button ng-if="!$root.expanded" ng-click="$root.expanded = true">+</button>
                    </th>
                    <th st-sort="name">Name</th>
                    <th st-sort="version">Version</th>
                    <th st-sort="release">Release</th>
                </tr>
                <tr ng-if="$root.expanded">
                    <th></th>
                    <th colspan="3">
                        <input st-search="" class="form-control" placeholder="global search ..." type="text"/>
                    </th>
                </tr>
                <tr ng-if="$root.expanded" ng-repeat="package in $root.assets">
                    <td><button ng-click="$scope.lel">Show Devices</button></td>
                    <td>{{ package.name }}</td>
                    <td>{{ package.version }}</td>
                    <td>{{ package.release }}</td>
                </tr>
            </tbody>
        </table>

        <h2>
            <span>AssetRuns</span>
        </h2>


        <uib-tabset>
            <uib-tab ng-repeat="dev in struct.devices">
                <uib-tab-heading>
                    {{ dev.full_name }}
                </uib-tab-heading>

                <h2>
                    <span ng-show="dev.assetrun_set_sf_src.length > 0">
                        AssetRun Overview
                    </span>
                </h2>
                <table
                    class="table table-condensed table-hover table-bordered"
                    style="width:auto;"
                    ng-show="dev.assetrun_set_sf_src.length > 0"
                    st-table="dev.assetrun_set"
                    st-safe-src="dev.assetrun_set_sf_src"
                    st-set-filter="strictFilter"
                >
                        <tbody>
                            <tr>
                                <th style="width: 30px;"></th>
                                <th st-sort="run_index">>Run Index</th>
                                <th st-sort="run_type">Run Type</th>
                                <th st-sort="run_start_time">Run Start</th>
                                <th st-sort="run_end_time">Run End</th>
                                <th st-sort="assets.length">Length</th>
                                <th>Assets</th>
                            </tr>
                            <tr>
				                <th colspan="7">
                                    <input st-search="" class="form-control" placeholder="global search ..." type="text"/>
                                </th>
			                </tr>
                            <tr>
                                <th colspan="2">
                                    <input st-search="run_index" placeholder="filter by run_index" class="input-sm form-control" type="search"/>
                                </th>
                                <th colspan="1">
                                    <input st-search="run_type" placeholder="filter by run_type" class="input-sm form-control" type="search"/>
                                </th>
                                <th colspan="1">
                                    <input st-search="run_start_time" placeholder="search by start_time" class="input-sm form-control" type="search"/>
                                </th>
                                <th colspan="1">
                                    <input st-search="run_end_time" placeholder="search by end_time" class="input-sm form-control" type="search"/>
                                </th>
			                </tr>
                            <tr ng-repeat="assetrun in dev.assetrun_set">
                                <td>
                                    <button ng-if="assetrun.expanded" ng-click="assetrun.expanded = false">-</button>
                                    <button ng-if="!assetrun.expanded" ng-click="assetrun.expanded = true">+</button>
                                </td>
                                <td>{{ assetrun.run_index }}</td>
                                <td>{{ assetrun.run_type }}</td>
                                <td>{{ assetrun.run_start_time }}</td>
                                <td>{{ assetrun.run_end_time }}</td>
                                <td>{{ assetrun.assets.length }}</td>

                                <td ng-if="assetrun.expanded">
                                    <table
                                        class="table table-condensed table-hover table-bordered"
                                        style="width:auto;"
                                        ng-show="assetrun.assets"
                                    >
                                        <tr>
                                            <th>Name</th>
                                        </tr>
                                        <tr ng-repeat="asset in assetrun.assets track by $index">
                                            <td>{{ asset }}</td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                    </tbody>
                </table>
            </uib-tab>
        </uib-tabset>



    </icsw-tools-ensure-device-selection>
</script>