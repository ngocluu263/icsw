<script type="text/ng-template" id="icsw.device.network.overview">
    <h3>
        Network config for {{ devices.length }} devices ({{ get_nd_objects().length }} netdevices, {{ get_ip_objects().length }} IPs, {{ get_peer_objects().length }} peers)
    </h3>
    <accordion close-others="no">
        <accordion-group is-open="device_open">
            <accordion-heading>
                <i class="glyphicon" ng-class="{'glyphicon-chevron-down': device_open, 'glyphicon-chevron-right': !device_open}"></i>
                {{ devices.length }} devices
            </accordion-heading>
            <table ng-show="devices.length" class="table table-condensed table-hover table-striped" style="width:auto;">
                <thead>
                    <tr>
                        <th>Device</th>
                        <th>Coms</th>
                        <th>ScanInfo</th>
                        <th>BootInfo</th>
                        <th>#Ports</th>
                        <th>#IPs</th>
                        <th>#peers</th>
                        <th>SNMP schemes</th>
                        <th colspan="2">action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr icsw-device-network-device-row ng-repeat="ndip_obj in devices"></tr>
                </tbody>
            </table>
        </accordion-group>
        <accordion-group is-open="netdevice_open">
            <accordion-heading>
                <i class="glyphicon" ng-class="{'glyphicon-chevron-down': netdevice_open, 'glyphicon-chevron-right': !netdevice_open}"></i>
                {{ get_nd_objects().length }} netdevices
            </accordion-heading>
            <icsw-tools-show-hide-columns ng-show="devices.length" columns="idx port ips peers bridge bond mac devtype mtu speed penalty flags status desired" create-show-column="true">
            </icsw-tools-show-hide-columns>
            <table ng-show="devices.length" class="table table-condensed table-hover table-striped" style="width:auto;">
                <thead>
                    <tr>
                        <th>Device</th>
                        <th ng-show="show_column.idx">idx</th>
                        <th ng-show="show_column.port">Port</th>
                        <th ng-show="show_column.ips">#IPs</th>
                        <th ng-show="show_column.peers">#peers</th>
                        <th ng-show="show_column.bridge">Bridge</th>
                        <th ng-show="show_column.bond">Bond</th>
                        <th ng-show="show_column.mac">MAC</th>
                        <th ng-show="show_column.devtype">Devtype</th>
                        <th ng-show="show_column.mtu">MTU</th>
                        <th ng-show="show_column.speed">speed</th>
                        <th ng-show="show_column.penalty">penalty</th>
                        <th ng-show="show_column.flags">flags</th>
                        <th ng-show="show_column.status">status</th>
                        <th ng-show="show_column.desired">desired</th>
                        <th colspan="4">action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr icsw-device-network-netdevice-row ng-repeat="ndip_obj in get_nd_objects()"></tr>
                </tbody>
            </table>
        </accordion-group>
        <accordion-group is-open="netip_open">
            <accordion-heading>
                <i class="glyphicon" ng-class="{'glyphicon-chevron-down': netip_open, 'glyphicon-chevron-right': !netip_open}"></i>
                {{ get_ip_objects().length }} IPs
            </accordion-heading>
            <table ng-show="devices.length" class="table table-condensed table-hover table-striped" style="width:auto;">
                <thead>
                    <tr>
                        <th>Device</th>
                        <th>Port</th>
                        <th>IP</th>
                        <th>Network</th>
                        <th>DTN</th>
                        <th>alias</th>
                        <th colspan="2">action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr icsw-device-network-ip-row ng-repeat="ndip_obj in get_ip_objects()"></tr>
                </tbody>
            </table>
        </accordion-group>
        <accordion-group is-open="peer_open">
            <accordion-heading>
                <i class="glyphicon" ng-class="{'glyphicon-chevron-down': peer_open, 'glyphicon-chevron-right': !peer_open}"></i>
                {{ get_peer_objects().length }} peer connections
            </accordion-heading>
            <table ng-show="devices.length" class="table table-condensed table-hover table-striped" style="width:auto;">
                <thead>
                    <tr>
                        <th>Device</th>
                        <th>Port</th>
                        <th>IPs</th>
                        <th>cost</th>
                        <th>Dest</th>
                        <th>type</th>
                        <th>Autocreated</th>
                        <th>Info</th>
                        <th colspan="2">action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr icsw-device-network-peer-row ng-repeat="ndip_obj in get_peer_objects()"></tr>
                </tbody>
            </table>
        </accordion-group>
    </accordion>
    <div class="input-group-btn" ng-show="devices.length > 1 && show_copy_button " ng-if="acl_create(null, 'backbone.device.change_network')">
        <div class="btn-group">
            <button type="button" class="btn btn-danger btn-md dropdown-toggle" data-toggle="dropdown">
                Copy network from<span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li ng-click="copy_network(obj, $event)" ng-repeat="obj in devices"><a href="#">{{ obj.full_name }}</a></li>
            </ul>
            <input type="button" ng-class="copy_com_class()" ng-value="copy_com_value()" ng-click="toggle_copy_com()"></input>
        </div>
    </div>
</script>

<script type="text/ng-template" id="icsw.device.com.capabilities">
    <button type="button" class="btn btn-xs" ng-class="com_class()" data-spinner-size="12" ladda="pending" data-style="expand-left">
    </button>
</script>

<script type="text/ng-template" id="icsw.device.network.device.row">
    <td>
        {{ ndip_obj.full_name }}
    </td>
    <td>
        <icsw-device-com-capabilities device="ndip_obj"></icsw-device-com-capabilities>
    </td>
    <td>
        <button type="button" class="btn btn-xs btn-warning" data-spinner-size="12" ng-show="ndip_obj.active_scan" ladda="ndip_obj.active_scan" data-style="expand-left">
            <span>{{ ndip_obj.active_scan }}</span>
        </button>
    </td>
    <td>
        <input
            type="button"
            class="btn btn-xs"
            ng-class="get_bootdevice_info_class(ndip_obj)"
            ng-show="get_num_bootips(ndip_obj)"
            ng-value="get_boot_value(ndip_obj)"
            ng-click="edit_boot_settings(ndip_obj, $event)">
        </input>
        <span ng-show="!get_num_bootips(ndip_obj)">N/A</span>
        <!--<button class="btn btn-primary btn-xs" ladda="true" data-style="expand-left">xxx</button>-->
    </td>
    <td>
        {{ get_num_netdevices(ndip_obj) }}
    </td>
    <td>
        {{ get_num_netips_dev(ndip_obj) }}
    </td>
    <td>
        {{ get_num_peers_dev(ndip_obj) }}
    </td>
    <td>
        <span ng-repeat="obj in ndip_obj.snmp_schemes">
            <span class="label label-info">{{ obj.full_name }}</span>
        </span>
    </td>
    <td>
        <button type="button" class="btn btn-xs btn-success pull-right"
            tooltip-placement="bottom"
            tooltip-html-unsafe="<div class='text-left'>
            devicegroup: {{ ndip_obj.device_group_name }}<br>
            comment: {{ ndip_obj.comment }}<br>
            </div>">
            <span class="glyphicon glyphicon-info-sign"></span>
        </button>
    </td>
    <td>
        <div ng-show="acl_create(ndip_obj, 'backbone.device.change_network') && !ndip_obj.active_scan">
            <div class="btn-group btn-xs">

                <button type="button" ng-attr-class="btn btn-xs dropdown-toggle fa fa-chevron-down {{ icswToolsButtonConfigService.get_css_class('create') }}" data-toggle="dropdown">
                    Create new
                </button>
                <ul class="dropdown-menu">
                    <li ng-click="create_netdevice(ndip_obj, $event)"><a href="#">Netdevice</a></li>
                    <li ng-show="ndip_obj.netdevice_set.length && networks.length" ng-click="create_netip_dev(ndip_obj, $event)"><a href="#">IP Address</a></li>
                    <li ng-show="ndip_obj.netdevice_set.length && nd_peers.length" ng-click="create_peer_information_dev(ndip_obj, $event)"><a href="#">Network topology connection</a></li>
                </ul>
            </div>
            <icsw-tools-button type="reload" value="update network" size="xs"
                ng-show="acl_create(obj, 'backbone.device.change_network')"
                ng-click="scan_device_network(ndip_obj, $event)">
            </icsw-tools-button>
        </div>
    </td>
</script>

<script type="text/ng-template" id="icsw.device.network.netdevice.row">
    <td>
        {{ dev_lut[ndip_obj.device].full_name }}
    </td>
    <td ng-show="show_column.idx">
        <span ng-show="ndip_obj.snmp_idx">{{ ndip_obj.snmp_idx }}</span>
    <td ng-show="show_column.port">
        <span ng-show="ndip_obj.enabled">
            {{ get_netdevice_name(ndip_obj) }}
        </span>
        <span ng-show="!ndip_obj.enabled">
            <em><strike>{{ get_netdevice_name(ndip_obj) }}</strike></em>
        </span>
    </td>
    <td ng-show="show_column.ips">
        {{ get_num_netips_nd(ndip_obj) }}
    </td>
    <td ng-show="show_column.peers">
        {{ get_num_peers_nd(ndip_obj) }}
    </td>
    <td ng-show="show_column.bridge">{{ get_bridge_info(ndip_obj) }}</td>
    <td ng-show="show_column.bond">{{ get_bond_info(ndip_obj) }}</td>
    <td ng-show="show_column.mac">{{ ndip_obj.macaddr }}</td>
    <td ng-show="show_column.devtype">{{ get_network_type(ndip_obj) }}</td>
    <td ng-show="show_column.mtu" class="text-right">{{ ndip_obj.mtu }}</td>
    <td ng-if="show_column.speed && ndip_obj.ignore_netdevice_speed" style="text-decoration: line-through;">
        {{ ndip_obj.netdevice_speed | array_lookup:netdevice_speeds:'info_string':'-' }}
    </td>
    <td ng-if="show_column.speed && !ndip_obj.ignore_netdevice_speed">
        {{ ndip_obj.netdevice_speed | array_lookup:netdevice_speeds:'info_string':'-' }}
    </td>
    <td ng-show="show_column.penalty" class="text-right">{{ ndip_obj.penalty }}</td>
    <td ng-show="show_column.flags">{{ get_flags(ndip_obj) }}</td>
    <td ng-show="show_column.status" ng-class="get_snmp_ao_status_class(ndip_obj)">{{ get_snmp_ao_status(ndip_obj) }}</td>
    <td ng-show="show_column.desired" class="text-center">{{ get_desired_status(ndip_obj) }}</td>
    <td>
        <button type="button" class="btn btn-xs btn-success"
         tooltip-placement="right"
         tooltip-html-unsafe="<div class='text-left'>
            device: {{ get_netdevice_name(ndip_obj) }}<br>
            SNMP: {{ ndip_obj.snmp_idx && 'yes' || 'no' }}<span ng-show='ndip_obj.snmp'> ( {{ ndip_obj.snmp_idx }} )</span><br>
            enabled: {{ ndip_obj.enabled | yesno2 }}<br>
            <hr>
            driver: {{ ndip_obj.driver }}<br>
            driver options: {{ ndip_obj.driver_options }}<br>
            fake MACAddress: {{ ndip_obj.fake_macaddr }}<br>
            force write DHCP: {{ ndip_obj.dhcp_device | yesno2 }}
            <hr>
            Autonegotiation: {{ ethtool_options(ndip_obj, 'a')}}<br>
            Duplex: {{ ethtool_options(ndip_obj, 'd')}}<br>
            Speed: {{ ethtool_options(ndip_obj, 's')}}
            <hr>
            Monitoring: {{ ndip_obj.netdevice_speed | array_lookup:netdevice_speeds:'info_string':'-' }}
         </div>">
         <span class="glyphicon glyphicon-info-sign"></span>
         </button>
    </td>
    <td>
        <div ng-show="!dev_lut[ndip_obj.device].active_scan">
            <icsw-tools-button type="modify" ng-click="edit_netdevice(ndip_obj, $event)" size="xs"
                    ng-show="acl_modify(obj, 'backbone.device.change_network')"></icsw-tools-button>
        </div>
    </td>
    <td>
        <div ng-show="!dev_lut[ndip_obj.device].active_scan">
            <icsw-tools-button type="delete" size="xs" ng-click="delete_netdevice(ndip_obj, $event)" ng-show="acl_delete(obj, 'backbone.device.change_network')"/>
        </div>
    </td>
    <td>
        <div class="btn-group btn-xs" ng-show="acl_create(obj, 'backbone.device.change_network') && !dev_lut[ndip_obj.device].active_scan">
            <button type="button" class="btn {{ icswToolsButtonConfigService.get_css_class('create') }} btn-xs dropdown-toggle" data-toggle="dropdown">
                Create new <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li ng-show="networks.length" ng-click="create_netip_nd(ndip_obj, $event)"><a href="#">IP Address</a></li>
                <li ng-click="create_peer_information_nd(ndip_obj, $event)"><a href="#">Network topology connection</a></li>
            </ul>
        </div>
    </td>
</script>

<script type="text/ng-template" id="icsw.device.network.ip.row">
    <td>{{ dev_lut[nd_lut[ndip_obj.netdevice].device].full_name }}</td>
    <td>{{ get_netdevice_name(ndip_obj.netdevice) }}</td>
    <td>{{ ndip_obj.ip }}</td>
    <td>{{ ndip_obj.network | array_lookup:networks:'info_string':'-' }}</td>
    <td>{{ ndip_obj.domain_tree_node | array_lookup:domain_tree_node:'tree_info':'-' }}</td>
    <td>
        <span ng-show="ndip_obj.alias">{{ ndip_obj.alias }} <span ng-show="ndip_obj.alias_excl">( exclusive )</span></span>
    </td>
    <td>
        <div ng-show="!dev_lut[nd_lut[ndip_obj.netdevice].device].active_scan">
            <icsw-tools-button type="modify" size="xs" ng-click="edit_netip(ndip_obj, $event)" ng-show="acl_modify(obj, 'backbone.device.change_network')"/>
        </div>
    </td>
    <td>
        <div ng-show="!dev_lut[nd_lut[ndip_obj.netdevice].device].active_scan">
            <icsw-tools-button type="delete" size="xs" ng-click="delete_netip(ndip_obj, $event)" ng-show="acl_delete(obj, 'backbone.device.change_network')"/>
        </div>
    </td>
</script>

<script type="text/ng-template" id="icsw.device.network.peer.row">
    <td>{{ dev_lut[nd_lut[ndip_obj.netdevice].device].full_name }}</td>
    <td>{{ get_netdevice_name(ndip_obj.netdevice) }} ({{ nd_lut[ndip_obj.netdevice].penalty }})</td>
    <td>
        <span ng-repeat="ip in get_ip_objects(nd_lut[ndip_obj.netdevice])">{{ ip.ip }}&nbsp;</span>
    </td>
    <td>
        with cost {{ ndip_obj.peer.penalty }}
        &nbsp;<span class="label label-primary">{{ get_peer_cost(ndip_obj) }}</span>&nbsp;
    </td>
    <td>
        to {{ get_peer_target(ndip_obj) }}
    </td>
    <td>
        {{ get_peer_type(ndip_obj) }}
    </td>
    <td class="text-center">
        {{ ndip_obj.peer.autocreated | yesno2 }}
    </td>
    <td>
        {{ ndip_obj.peer.info }}
    </td>
    <td>
        <icsw-tools-button type="modify" size="xs" ng-click="edit_peer_information(ndip_obj, $event)" ng-show="acl_modify(obj, 'backbone.device.change_network')"></icsw-tools-button>
    </td>
    <td>
        <icsw-tools-button type="delete" size="xs" ng-click="delete_peer_information(ndip_obj, $event)" ng-show="acl_delete(obj, 'backbone.device.change_network')"></icsw-tools-button>
    </td>
</script>

<script type="text/ng-template" id="icsw.device.network.cluster.info">
    <ul>
        <li ng-repeat="device in devices">
            {{ device.full_name }} ({{ device.device_group_name }})
        </li>
    </ul>
</script>

<script type="text/ng-template" id="icsw.device.network.host.node">
    <g class="node draggable" node_id="{{ node.id }}"
        ng-mouseenter="mouse_enter()"
        ng-mouseleave="mouse_leave()"
        ng-click="mouse_click()"
    >
        <circle r="18" fill="{{ fill_color }}" stroke-width="{{ stroke_width }}" stroke="{{ stroke_color }}" cursor="crosshair"></circle>
        <text text-anchor="middle" alignment-baseline="middle" cursor="crosshair">{{ node.name }}</text>
    </g>
</script>

<script type="text/ng-template" id="icsw.device.network.host.livestatus">
    <g class="node draggable" node_id="{{ node.id }}">
        <newburst
            ls-filter="ls_filter"
            device-pk="devicepk"
            innerradius="20"
            outerradius="30"
            noninteractive="true"
            zoom-level="d"
        ></newburst>
        <text text-anchor="middle" alignment-baseline="middle" cursor="crosshair">{{ node.name }}</text>
    </g>
</script>

<script type="text/ng-template" id="icsw.device.network.host.link">
    <line stroke="#ff7788" stroke-width="2" opacity="1">
    </line>
</script>

<script type="text/ng-template" id="icsw.device.network.graph">
    <div>
        <h4>{{ zoom.factor | number:2 }}@({{ offset.x | number:0 }}, {{ offset.y | number:0 }})</h4>
        <icsw-device-network-graph2 icsw-mouse-capture></icsw-device-network-graph2>
    </div>
</script>

<script type="text/ng-template" id="icsw.device.network.graph2">
    <svg
        class="draggable"
        ng-attr-width="{{ size.width }}"
        ng-attr-height="{{ size.height }}"
        ng-attr-viewBox="0 0 {{ size.width }} {{ size.height }}"
        preserveAspectRatio="xMidYMid"
        pointer-events="all"
        msd-wheel="mouse_wheel($event, $delta, $deltax, $deltay)"
        ng-mousedown="mouse_down($event)"
    >
        <!-- translate before scale: no need to scale offsets -->
        <rect style="stroke:black;stroke-width:2px;fill-opacity:0" x="0" y="0" ng-attr-width="{{ size.width }}" ng-attr-height="{{ size.height }}"></rect>
        <g ng-attr-transform="translate({{ offset.x }}, {{ offset.y }}) scale({{ zoom.factor }})">
            <icsw-device-network-host-link ng-repeat="link in links" link="link" redraw="redraw_nodes"></icsw-device-network-host-link>
            <icsw-device-network-host-livestatus
                ng-if="show_livestatus"
                devicepk="node.id"
                icsw-device-network-node-transform="node"
                icsw-device-network-node-dbl-click="node"
                ng-repeat="node in nodes"
                ls-filter="ls_filter"
                redraw="redraw_nodes"
                ng-dblclick="double_click($event)"
            ></icsw-device-network-host-livestatus>
            <icsw-device-network-host-node
                icsw-device-network-node-transform="node"
                icsw-device-network-node-dbl-click="node"
                ng-repeat="node in nodes"
                node="node"
                redraw="redraw_nodes"
                ng-dblclick="double_click($event)"
            ></icsw-device-network-host-node>
        </g>
    </svg>
</script>

<script type="text/ng-template" id="icsw.device.network.total">
    <uib-tabset icsw-tools-add-acl-functions>
        <uib-tab heading="Device settings">
            <icsw-device-network-overview icsw-sel-man="0" icsw-sel-man-sel-mode="d" show-copy-button="1">
            </icsw-device-network-overview>
        </uib-tab>

        <uib-tab heading="Network topology">
            <div ng-controller="icswDeviceNetworkGraphCtrl">
                <h3>
                    Network topology for {{ devices.length }} devices
                </h3>
                <form class="form-inline">
                    Show network topology for
                    <div class="form-group">
                        <select ng-model="graph_sel" class="form-control" ng-change="fetch_data()">
                            <option value="none">none</option>
                            <option value="all_with_peers" title="all devices with peers" ng-if="acl_read(null, 'backbone.network.show_clusters')">all peered</option>
                            <option value="all" title="all devices">all</option>
                            <option value="sel">selected</option>
                            <option value="selp1" ng-if="acl_read(null, 'backbone.network.show_clusters')">selected + 1 (next ring)</option>
                            <option value="selp2" ng-if="acl_read(null, 'backbone.network.show_clusters')">selected + 2</option>
                            <option value="selp3" ng-if="acl_read(null, 'backbone.network.show_clusters')">selected + 3</option>
                            <option value="core" ng-if="acl_read(null, 'backbone.network.show_clusters')">core (non-trivial)</option>
                        </select>, mode:
                    </div>
                    <div class="form-group">
                        <icsw-tools-button type="reload" value="Redraw" size="sm" ng-click="fetch_data()"></icsw-tools-button>
                    </div>
                    <div class="form-group">,
                        <icsw-tools-button type="show" value="Show Livestatus" size="sm" is-show="!show_livestatus" ng-click="show_livestatus = !show_livestatus">
                        </icsw-tools-button>
                        livestatus
                    </div>
                    <icsw-device-livestatus-filter ng-show="show_livestatus" ls-filter="ls_filter"></icsw-device-livestatus-filter>
                </form>
                <icsw-device-network-graph ls-filter="ls_filter"></icsw-device-network-graph>
            </div>
        </uib-tab>
        <uib-tab heading="Clusters" ng-if="acl_read(null, 'backbone.network.show_clusters')">
            <div ng-controller="icswDeviceNetworkClusterCtrl">
                <h3>
                    Network clusters ({{ clusters.length }}), <icsw-tools-button type="reload" value="reload" size="sm" ng-click="reload()"></icsw-tools-button>
                </h3>
                <table class="table table-condensed table-hover table-striped" style="width:auto;">
                    <thead>
                        <tr>
                            <th>Index</th>
                            <th>has netdevices</th>
                            <th>devices</th>
                            <th>netdevices</th>
                            <th>selected</th>
                            <th>action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="cluster in clusters">
                            <td>{{ $index + 1 }}</td>
                            <td>{{ cluster.with_netdevices | yesno2 }}</td>
                            <td class="text-right">{{ cluster.devices }}</td>
                            <td class="text-right">{{ cluster.net_devices }}</td>
                            <td class="text-center">{{ is_selected(cluster) }}</td>
                            <td>
                                <input type="button" class="btn btn-xs btn-primary" value="show" ng-click="show_cluster(cluster)"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </uib-tab>

        <uib-tab heading="Networks">
            <icsw-tools-rest-table target-list="entries" config-service="icswNetworkService">
                <h3>
                    Networks ({{entries.length}} entries),
                    <div class="btn-group">
                        <icsw-tools-button type="create" ng-click="create($event)" size="sm"></icsw-tools-button>
                        <icsw-tools-button type="reload" ng-click="reload()" size="sm"></icsw-tools-button>
                    </div>
                </h3>

                <table st-table="entries_displayed" st-safe-src="entries"
                       class="table table-hover table-condensed table-striped" style="width:auto;">

                    <thead>
                        <tr>
                            <td colspan="99">
                                <div icsw-tools-pagination st-items-by-page="10" st-displayed-pages="11"
                                     possible-items-by-page="10,20,50,100,200,500,1000">
                                </div>
                                <icsw-tools-show-hide-columns columns="network gateway autorange prefDTN" create-show-column="true">
                                </icsw-tools-show-hide-columns>
                            </td>
                        </tr>
                        <tr>
                            <th st-sort="identifier" st-sort-default="true">Id</th>
                            <th ng-show="show_column.network" st-sort="network">Network definition</th>
                            <th ng-show="show_column.gateway" st-sort="gateway">Gateway</th>
                            <th ng-show="show_column.gateway" st-sort="gw_pri">gw pri</th>
                            <th ng-show="show_column.autorange">AutoRange</th>
                            <th st-sort="num_ip">#IPs</th>
                            <th st-sort="penalty">Penalty</th>
                            <th st-sort="enforce_unique_ips">uniqueIP</th>
                            <th st-sort="network_type">Type</th>
                            <th st-sort="master_network">Master</th>
                            <th ng-show="show_column.prefDTN">preferred DTN</th>
                            <th st-sort="network_device_type">devtype(s)</th>
                            <th colspan="2" class="text-center">action</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr ng-repeat="obj in entries_displayed">
                            <td>{{ obj.identifier }}</td>
                            <td ng-show="show_column.network" style="font-family:monospace;">
                                <span style="background-color:#ededed;" ng-bind-html="obj.network | ip_fixed_width"></span> /
                                <span style="background-color:#ededed;" ng-bind-html="obj.netmask | ip_fixed_width"></span> /
                                <span style="background-color:#ededed;" ng-bind-html="obj.broadcast | ip_fixed_width"></span>
                            </td>
                            <td ng-show="show_column.gateway" style="font-family:monospace;">
                                <span style="background-color:#ededed;" ng-bind-html="obj.gateway | ip_fixed_width"></span>
                            </td>
                            <td ng-show="show_column.gateway" class="text-center">
                                <span class="badge">{{ obj.gw_pri }}</span>
                            </td>
                            <td ng-show="show_column.autorange" style="font-family:monospace;">
                                <span ng-switch="config_service.autorange_set(obj)">
                                    <span ng-switch-when="true">
                                        <span style="background-color:#ededed;" ng-bind-html="obj.start_range | ip_fixed_width"></span> -
                                        <span style="background-color:#ededed;" ng-bind-html="obj.end_range | ip_fixed_width"></span>
                                    </span>
                                    <span ng-switch-default>
                                        ----
                                    </span>
                                </span>
                            </td>
                            <td class="text-right">{{ obj.num_ip }}</td>
                            <td class="text-center">{{ obj.penalty }}</td>
                            <td class="text-center">{{ obj.enforce_unique_ips | yesno1 }}</td>
                            <td>
                                {{ obj.network_type | array_lookup:config_service.network_types:'description' }}
                            </td>
                            <td>
                                {{ obj.master_network | array_lookup:entries:'identifier':'---' }}
                            </td>
                            <td ng-show="show_column.prefDTN">
                                {{ config_service.preferred_dtn(obj) }}
                            </td>
                            <td>
                                {{ obj.network_device_type | resolve_n2m:config_service.network_device_types:'identifier':'---' }}
                            </td>
                            <td>
                                <icsw-tools-button type="modify" size="xs" ng-click="edit($event, obj)"/>
                            </td>
                            <td>
                                <icsw-tools-button type="delete" ng-show="obj.num_ip == 0" ng-click="delete(obj)" size="xs">
                                </icsw-tools-button>
                                <icsw-tools-button type="show" ng-show="obj.num_ip > 0" size="xs"
                                                   is-show="config_service.network_display.active_network != obj "
                                                   ng-click="config_service.show_network(obj)">
                                </icsw-tools-button>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div ng-show="config_service.network_display.active_network" >
                    <h3>Network {{ config_service.network_display.active_network.identifier }}, {{ config_service.network_display.active_network.num_ip }} IP addresses</h3>
                    <table st-table="network_entries_displayed" st-safe-src="config_service.network_display.iplist" class="table table-condensed table-hover" style="width:auto;">
                        <thead>
                            <tr>
                                <td colspan="99">
                                    <div icsw-tools-pagination st-items-by-page="10" st-displayed-pages="11" possible-items-by-page="10,20,50,100,200,500,1000"></div>
                                </td>
                            </tr>
                            <tr>
                                <th st-sort="ip">IP</th>
                                <th st-sort="netdevice_name">Netdevice</th>
                                <th st-sort="device_full_name">Device</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="obj in network_entries_displayed">
                               <td>{{ obj.ip }}</td>
                               <td>{{ obj.netdevice_name }}</td>
                               <td>{{ obj.device_full_name }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </icsw-tools-rest-table>
        </uib-tab>

        <uib-tab heading="Network types">
            <icsw-tools-rest-table target-list="entries" config-service="icswNetworkTypeService">
                <h3>Network types ({{entries.length}} entries), <icsw-tools-button type="create" value="create new" ng-click="create($event)" size="sm"/></h3>
                <table st-table="entries_displayed" st-safe-src="entries"
                       class="table table-hover table-condensed table-striped" style="width:auto;">
                    <thead>
                        <tr>
                            <th st-sort="identifier" st-sort-default="true">Type</th>
                            <th st-sort="description">Description</th>
                            <th colspan="2" class="text-center">action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="obj in entries_displayed">
                            <td>{{ obj.identifier }}</td>
                            <td>{{ obj.description }}</td>
                            <td><icsw-tools-button type="modify" ng-click="edit($event, obj)" size="xs"></icsw-tools-button></td>
                            <td><icsw-tools-button type="delete" ng-click="delete(obj)" size="xs"></icsw-tools-button></td>
                        </tr>
                    </tbody>
                </table>
            </icsw-tools-rest-table>
        </uib-tab>

        <uib-tab heading="Network device types">
            <icsw-tools-rest-table target-list="entries" config-service="icswNetworkDeviceTypeService">
                <h3>Network device types ({{entries.length}} entries), <icsw-tools-button type="create" ng-click="create($event)" size="sm"/></h3>
                <table st-table="entries_displayed" st-safe-src="entries"
                       class="table table-hover table-condensed table-striped" style="width:auto;">
                    <thead>
                        <tr>
                            <td colspan="99">
                                <div icsw-tools-pagination st-items-by-page="10" st-displayed-pages="11" possible-items-by-page="10,20,50,100,200,500,1000"></div>
                            </td>
                        </tr>
                        <tr>
                            <th st-sort="identifier" st-sort-default="true">Id</th>
                            <th st-sort="description">Description</th>
                            <th st-sort="name_re">RegExp</th>
                            <th st-sort="mac_bytes">MAC bytes</th>
                            <th st-sort="allow_virtual_interfaces">virtIF allowed</th>
                            <th st-sort="for_matching">for matching</th>
                            <th st-sort="auto_created">Autocreated</th>
                            <th colspan="2" class="text-center">action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="obj in entries_displayed">
                            <td>{{ obj.identifier }}</td>
                            <td>{{ obj.description  }}</td>
                            <td>{{ obj.name_re }}</td>
                            <td class="text-center">{{ obj.mac_bytes }}</td>
                            <td class="text-center">{{ obj.allow_virtual_interfaces | yesno1 }}</td>
                            <td class="text-center">{{ obj.for_matching | yesno2 }}</td>
                            <td class="text-center">{{ obj.auto_created | yesno2 }}</td>
                            <td><icsw-tools-button type="modify" ng-click="edit($event, obj)" size="xs"></icsw-tools-button></td>
                            <td><icsw-tools-button type="delete" ng-click="delete(obj)" size="xs"></icsw-tools-button></td>
                        </tr>
                    </tbody>
                </table>
            </icsw-tools-rest-table>
        </uib-tab>
    </uib-tabset>
</script>

<script type="text/ng-template" id="network.device.type.form">
    <form id="form" class="form-horizontal" ng-submit="modify()" name="form">
        <h2>Network device type</h2>
        <fieldset>
            <legend>Base data</legend>
            <div class="form-group ng-class:form_error('identifier')">
                <label class="control-label col-sm-3 requiredField">
                    Identifier<span class="asteriskField">*</span></label>
                <div class="controls col-sm-7">
                    <input class="textinput textInput form-control" maxlength="48" name="identifier" ng-model="edit_obj.identifier" placeholder="Identifier" required="True" type="text"/>
                </div>
            </div>
            <div class="form-group ng-class:form_error('description')">
                <label class="control-label col-sm-3 requiredField">
                    Description<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-7">
                    <input class="textinput textInput form-control" maxlength="192" name="description" ng-model="edit_obj.description" placeholder="Description" required="True" type="text"/>
                </div>
            </div>
            <div class="form-group ng-class:form_error('name_re')">
                <label class="control-label col-sm-3 requiredField">
                    Name regexp<span class="asteriskField">*</span></label>
                <div class="controls col-sm-7">
                    <input class="textinput textInput form-control" maxlength="128" name="name_re" ng-model="edit_obj.name_re" placeholder="Regular expression" required="True" type="text" value="^.*$"/>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3 requiredField">
                    #MAC bytes<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-7">
                    <input class="numberinput form-control" max="24" min="6" ng-model="edit_obj.mac_bytes" placeholder="MAC bytes" required="True" type="number" value="6"></input>
                </div>
            </div>
        </fieldset>
        <fieldset>
            <legend>Flags</legend>
            <div class="form-group">
                <div class="checkbox">
                    <div class="controls col-sm-7">
                        <label>
                            <input checked="checked" class="checkboxinput checkbox" ng-model="edit_obj.allow_virtual_interfaces" type="checkbox"/>
                            Allow virtual interfaces
                        </label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="checkbox">
                    <div class="controls col-sm-7">
                        <label>
                            <input checked="checked" class="checkboxinput checkbox" ng-model="edit_obj.for_matching" type="checkbox"/>
                            Used for matching
                        </label>
                    </div>
                </div>
            </div>
        </fieldset>
        <div class="form-actions"><input type="submit" name="submit" value="" class="btn btn-primary primaryAction" id="submit-id-submit" ng-value="get_action_string()"></input></div>
    </form>
</script>

<script type="text/ng-template" id="netdevice.form">
    <form id="form" class="form-horizontal" ng-submit="cur_edit.modify(this)" name="form">
        <uib-tabset>
            <uib-tab heading="Basic settings">
                <fieldset>
                    <div class="form-group  ng-class:form_error('devname')">
                        <label class="control-label col-sm-3 requiredField">
                            Devname<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-8">
                            <input class="textinput textInput form-control" maxlength="64" ng-model="_edit_obj.devname" placeholder="devicename" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Description
                        </label>
                        <div class="controls col-sm-8">
                            <input class="textinput textInput form-control" maxlength="765" ng-model="_edit_obj.description" type="text"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 requiredField">
                            MTU<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-8">
                            <input class="numberinput form-control" ng-model="_edit_obj.mtu" required="True" type="number" value="1500"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Netdevice speed
                        </label>
                        <div class="controls col-sm-8">
                            <ui-select ng-model="_edit_obj.netdevice_speed" style="max-width:400px; min-width:240px;" ng-disabled="false">
                                <ui-select-match placeholder="select a target netdevice speed">{{$select.selected.info_string}}</ui-select-match>
                                <ui-select-choices repeat="value.idx as value in netdevice_speeds">
                                    <div ng-bind-html="value.info_string | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-8">
                                <label>
                                    <input class="checkboxinput checkbox" ng-model="_edit_obj.ignore_netdevice_speed" type="checkbox"/>
                                    Ignore netdevice speed
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-8">
                                <label>
                                    <input class="checkboxinput checkbox" ng-model="_edit_obj.enabled" type="checkbox"/>
                                    Enabled
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Desired status
                        </label>
                        <div class="controls col-sm-8">
                            <ui-select ng-model="_edit_obj.desired_status" style="max-width:400px; min-width:240px;" ng-disabled="false">
                                <ui-select-match placeholder="select the desired status">{{$select.selected.info_string}}</ui-select-match>
                                <ui-select-choices repeat="value.short as value in desired_stati">
                                    <div ng-bind-html="value.info_string | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>Routing settings</legend>
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-8">
                                <label>
                                    <input class="checkboxinput checkbox" ng-model="_edit_obj.routing" type="checkbox"/>
                                    network topology central node
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Cost
                        </label>
                        <div class="controls col-sm-8">
                            <input class="numberinput form-control" max="128" min="1" name="penalty" ng-model="_edit_obj.penalty" type="number" value="1"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-8">
                                <label>
                                    <input class="checkboxinput checkbox" ng-model="_edit_obj.inter_device_routing" type="checkbox"/>
                                    Inter device routing
                                </label>
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset ng-show="!_edit_obj.is_bridge && !_edit_obj.is_bond && !_edit_obj.bond_master && !_edit_obj.bridge_device && get_vlan_masters(_edit_obj).length">
                    <legend>VLAN settings</legend>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Master device
                        </label>
                        <div class="controls col-sm-8">
                            <div class="input-group" style="max-width:400px; min-width:240px;">
                                <ui-select ng-model="_edit_obj.master_device" ng-disabled="false">
                                    <ui-select-match placeholder="VLAN master device">{{$select.selected.devname}}</ui-select-match>
                                    <ui-select-choices repeat="value.idx as value in get_vlan_masters(_edit_obj)">
                                        <div ng-bind-html="value.devname | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="_edit_obj.master_device = undefined" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            VLAN id
                        </label>
                        <div class="controls col-sm-8">
                            <input class="numberinput form-control" max="255" min="0" ng-model="_edit_obj.vlan_id" type="number" value="0"/>
                        </div>
                    </div>
                </fieldset>
            </uib-tab>
            <uib-tab heading="Bridge / Bond">
                <fieldset ng-show="!_edit_obj.vlan_id && !_edit_obj.bond_master && !_edit_obj.is_bond">
                    <legend>Bridge settings</legend>
                    <div class="form-group">
                        <div class="checkbox" ng_show="!_edit_obj.bridge_device">
                            <div class="controls col-lg-offset-0 col-sm-8">
                                <label>
                                    <input class="checkboxinput checkbox" ng-disabled="has_bridge_slaves(_edit_obj)" ng-model="_edit_obj.is_bridge" type="checkbox"/>
                                    Is bridge device
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng_show="!_edit_obj.is_bridge && get_bridge_masters(_edit_obj).length">
                        <label class="control-label col-sm-3">
                            Bridge device
                        </label>
                        <div class="controls col-sm-8">
                            <div class="input-group" style="max-width:400px; min-width:240px;">
                                <ui-select ng-model="_edit_obj.bridge_device" style="max-width:400px; min-width:240px;" ng-disabled="false">
                                    <ui-select-match placeholder="bridge master device">{{ $select.selected.devname }}</ui-select-match>
                                    <ui-select-choices repeat="value.idx as value in get_bridge_masters(_edit_obj)">
                                        <div ng-bind-html="value.devname | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="_edit_obj.bridge_device = undefined" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset ng-show="!_edit_obj.vlan_id && !_edit_obj.bridge_device && !_edit_obj.is_bridge">
                    <legend>Bond settings</legend>
                    <div class="form-group">
                        <div class="checkbox" ng_show="!_edit_obj.bond_master">
                            <div class="controls col-lg-offset-0 col-sm-8">
                                <label>
                                    <input class="checkboxinput checkbox" ng-disabled="has_bond_slaves(_edit_obj)" ng-model="_edit_obj.is_bond" type="checkbox"/>
                                    Is bond master
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng_show="!_edit_obj.is_bond && get_bond_masters(_edit_obj).length">
                        <label class="control-label col-sm-3">
                            Bond master
                        </label>
                        <div class="controls col-sm-8">
                            <div class="input-group" style="max-width:400px; min-width:240px;">
                                <ui-select ng-model="_edit_obj.bond_master" style="max-width:400px; min-width:240px;" ng-disabled="false">
                                    <ui-select-match placeholder="bond master device">{{ $select.selected.devname }}</ui-select-match>
                                    <ui-select-choices repeat="value.idx as value in get_bond_masters(_edit_obj)">
                                        <div ng-bind-html="value.devname | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="_edit_obj.bond_master = undefined" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </uib-tab>
            <uib-tab heading="Hardware">
                <fieldset>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Driver
                        </label>
                        <div class="controls col-sm-8">
                            <input class="textinput textInput form-control" maxlength="384" ng-model="_edit_obj.driver" type="text" value="e1000e"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Driver options
                        </label>
                        <div class="controls col-sm-8">
                            <input class="textinput textInput form-control" maxlength="672" ng-model="_edit_obj.driver_options" type="text"/>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>ethtool settings (for cluster boot)</legend>
                    <div class="form-group">
                        <label class="control-label col-sm-3 requiredField">
                            Ethtool autoneg<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-8">
                            <select class="select form-control" ng-change="update_ethtool(_edit_obj)" ng-model="_edit_obj.ethtool_autoneg" ng-options="a.id as a.option for a in ethtool_autoneg">
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 requiredField">
                            Ethtool duplex<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-8">
                            <select class="select form-control" ng-change="update_ethtool(_edit_obj)" ng-model="_edit_obj.ethtool_duplex" ng-options="a.id as a.option for a in ethtool_duplex">
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3 requiredField">
                            Ethtool speed<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-8">
                            <select class="select form-control" ng-change="update_ethtool(_edit_obj)" ng-model="_edit_obj.ethtool_speed" ng-options="a.id as a.option for a in ethtool_speed">
                            </select>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>MAC Address settings</legend>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="control-label col-sm-3">
                                    MAC-Address
                                </label>
                                <div class="controls col-sm-8">
                                    <input class="textinput textInput form-control" maxlength="177" name="macaddr" ng-model="_edit_obj.macaddr" type="text"/>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="control-label col-sm-3">
                                    Fake MAC-Address
                                </label>
                                <div class="controls col-sm-8">
                                    <input class="textinput textInput form-control" maxlength="177" name="fake_macaddr" ng-model="_edit_obj.fake_macaddr" type="text"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-8">
                                <label>
                                    <input class="checkboxinput checkbox" ng-model="_edit_obj.dhcp_device" type="checkbox"/>
                                    force write DHCP address (greedy mode will not work)
                                </label>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </uib-tab>
        </uib-tabset>
        <div class="form-actions">
            <input type="submit" name="submit" value="" class="btn btn-primary primaryAction" id="submit-id-submit" ng-value="action_string"/>
        </div>
    </form>
</script>

<script type="text/ng-template" id="network.form">
    <form id="form" class="form-horizontal" ng-submit="modify()" name="form">
        <uib-tabset>
            <uib-tab heading="Base data">
                <fieldset>
                    <legend>Base data</legend>
                    <div class="form-group ng-class:form_error('identifier')">
                        <label class="control-label col-sm-3 requiredField">
                            Identifier<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <input class="textinput textInput form-control" maxlength="255" name="identifier" ng-model="edit_obj.identifier" placeholder="Identifier" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group  ng-class:form_error('network')">
                        <label class="control-label col-sm-3 requiredField">
                            Network<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <input class="textinput textInput form-control" name="network" ng-blur="config_service.network_or_netmask_blur(edit_obj)" ng-model="edit_obj.network" ng-pattern="/^\d+\.\d+\.\d+\.\d+$/" placeholder="Network" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group  ng-class:form_error('netmask')">
                        <label class="control-label col-sm-3 requiredField">
                            Netmask<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <input class="textinput textInput form-control" name="netmask" ng-blur="config_service.network_or_netmask_blur(edit_obj)" ng-model="edit_obj.netmask" ng-pattern="/^\d+\.\d+\.\d+\.\d+$/" placeholder="Netmask" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group  ng-class:form_error('broadcast')">
                        <label class="control-label col-sm-3 requiredField">
                            Broadcast<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <input class="textinput textInput form-control" name="broadcast" ng-model="edit_obj.broadcast" ng-pattern="/^\d+\.\d+\.\d+\.\d+$/" placeholder="Broadcast" required="True" type="text"/>
                        </div>
                    </div>
                    <div class="form-group  ng-class:form_error('gateway')">
                        <label class="control-label col-sm-3 requiredField">
                            Gateway<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <input class="textinput textInput form-control" name="gateway" ng-model="edit_obj.gateway" ng-pattern="/^\d+\.\d+\.\d+\.\d+$/" placeholder="Gateway" required="True" type="text"/>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>Network type (master / slave)</legend>
                    <div class="form-group">
                        <label class="control-label col-sm-3 requiredField">
                            Network type<span class="asteriskField">*</span>
                        </label>
                        <div class="controls col-sm-7">
                            <ui-select ng-model="edit_obj.network_type" style="max-width:400px; min-width:240px;" ng-disabled="has_master_network(edit_obj)">
                                <ui-select-match placeholder="network type">{{$select.selected.description}}</ui-select-match>
                                <ui-select-choices repeat="value.idx as value in config_service.network_types| props_filter:{description:$select.search}">
                                    <div ng-bind-html="value.description | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                    <div class="form-group" ng_show="config_service.is_slave_network(edit_obj.network_type)">
                        <label class="control-label col-sm-3">
                            Master network
                        </label>
                        <div class="controls col-sm-7">
                            <div class="input-group" style="max-width:400px; min-width:240px;">
                                <ui-select ng-model="edit_obj.master_network" ng-disabled="false">
                                    <ui-select-match placeholder="master network">{{$select.selected.identifier}}
                                    </ui-select-match>
                                    <ui-select-choices repeat="value.idx as value in config_service.get_production_networks()| props_filter:{identifier:$select.search}">
                                        <div ng-bind-html="value.identifier | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="edit_obj.master_network = undefined" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </uib-tab>
            <uib-tab heading="Flags / Range">
                <fieldset>
                    <legend>Flags and priority</legend>
                    <div class="form-group">
                        <div class="checkbox">
                            <div class="controls col-lg-offset-0 col-sm-7">
                                <label>
                                    <input class="checkboxinput checkbox" ng-model="edit_obj.enforce_unique_ips" type="checkbox"/>
                                    Enforce unique ips
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Gw pri
                        </label>
                        <div class="controls col-sm-7">
                            <input class="numberinput form-control" name="gw_pri" ng-model="edit_obj.gw_pri" type="number" value="1"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Preferred domain tree node
                        </label>
                        {{  config_service.domain_tree_node_list }}
                        <div class="controls col-sm-7">
                            <div class="input-group" style="max-width:400px; min-width:240px;">
                                <ui-select ng-model="edit_obj.preferred_domain_tree_node">
                                    <ui-select-match placeholder="preferred DTN">{{$select.selected.info}}</ui-select-match>
                                    <ui-select-choices
                                        repeat="value.idx as value in config_service.domain_tree_node_list() | props_filter:{full_name:$select.search}"
                                        refresh="config_service.refresh_domain_tree_node()"
                                    >
                                        <div ng-bind-html="value.info | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="edit_obj.preferred_domain_tree_node = undefined" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-3">
                            Network device type
                        </label>
                        <div class="controls col-sm-7">
                            <ui-select multiple="multiple" ng-model="edit_obj.network_device_type" style="max-width:400px; min-width:240px;" ng-disabled="false">
                                <ui-select-match placeholder="network device types">{{$item.identifier}}</ui-select-match>
                                <ui-select-choices repeat="value.idx as value in config_service.network_device_types| props_filter:{identifier:$select.search}">
                                    <div ng-bind-html="value.identifier | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>Range</legend>
                    <div class="form-group ng-class:form_error('start_range')">
                        <label class="control-label col-sm-5 requiredField">
                            Range Start (incl.)
                        </label>
                        <div class="controls col-sm-6">
                            <div class="input-group">
                                <input class="textinput textInput form-control" ng-focus="config_service.enter_range(edit_obj)" ng-blur="config_service.range_check(edit_obj)" ng-model="edit_obj.start_range" ng-pattern="/^\d+\.\d+\.\d+\.\d+$/" placeholder="Range start"  type="text"/>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="config_service.clear_range(edit_obj)" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group ng-class:form_error('end_range')">
                        <label class="control-label col-sm-5 requiredField">
                            Range End (incl.)
                        </label>
                        <div class="controls col-sm-6">
                            <div class="input-group">
                                <input class="textinput textInput form-control" ng-focus="config_service.enter_range(edit_obj)" ng-blur="config_service.range_check(edit_obj)" ng-model="edit_obj.end_range" ng-pattern="/^\d+\.\d+\.\d+\.\d+$/" placeholder="Range end" type="text"/>
                                <span class="input-group-btn">
                                    <button type="button" ng-click="config_service.clear_range(edit_obj)" class="btn btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </uib-tab>
        </uib-tabset>
        <div class="form-actions">
            <input type="submit" name="submit" value="" class="btn btn-primary primaryAction" id="submit-id-submit" ng-value="get_action_string()"/>
        </div>
    </form>
</script>

<script type="text/ng-template" id="network.type.form">
    <form id="form" class="form-horizontal" ng-submit="modify()" name="form">
        <fieldset>
            <legend>Base data</legend>
            <div class="form-group  ng-class:form_error('description')">
                <label class="control-label col-sm-3 requiredField">
                    Description<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-7">
                    <input class="textinput textInput form-control" maxlength="192" name="description" ng-model="edit_obj.description" placeholder="Description" required="True" type="text"/>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3 requiredField">
                    Identifier<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-7">
                    <ui-select ng-model="edit_obj.identifier" style="max-width:400px; min-width:240px;" ng-disabled="false">
                        <ui-select-match placeholder="network type type">{{$select.selected.name}}</ui-select-match>
                        <ui-select-choices repeat="value.value as value in config_service.network_types">
                            <div ng-bind-html="value.name | highlight: $select.search"></div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            </div>
        </fieldset>
        <div class="form-actions">
            <input type="submit" name="submit" value="" class="btn btn-primary primaryAction" id="submit-id-submit" ng-value="get_action_string()"/>
        </div>
    </form>
</script>

<script type="text/ng-template" id="net.ip.form">
    <form id="form" class="form-horizontal" ng-submit="cur_edit.modify(this)" name="form">
        <fieldset>
            <legend>Basic settings</legend>
            <div class="form-group">
                <label class="control-label col-sm-4 requiredField">
                    Netdevice<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-8">
                    <ui-select ng-model="_edit_obj.netdevice" style="max-width:400px; min-width:240px;" ng-disabled="!create_mode">-->
                        <ui-select-match placeholder="netdevice">{{$select.selected.devname}}</ui-select-match>
                        <ui-select-choices repeat="value.idx as value in _current_dev.netdevice_set">
                            <div ng-bind-html="value.devname | highlight: $select.search"></div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-4 requiredField">
                    Network<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-8">
                    <ui-select ng-model="_edit_obj.network" ng-change="network_changed(_edit_obj)" style="max-width:400px; min-width:240px;" ng-disabled="false">
                        <ui-select-match placeholder="network">{{$select.selected.info_string}}</ui-select-match>
                        <ui-select-choices repeat="value.idx as value in networks| props_filter:{info_string:$select.search}" position="down">
                            <div ng-bind-html="value.info_string | highlight: $select.search"></div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            </div>
            <div class="form-group  ng-class:form_error('devname')">
                <label class="control-label col-sm-4 requiredField">
                    IP<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-8">
                    <div class="input-group" style="max-width:400px; min-width:240px;">
                        <input class="textinput textInput form-control" maxlength="16" name="ip" ng-model="_edit_obj.ip" placeholder="IP address" required="True" type="text"/>
                        <span class="input-group-btn">
                            <icsw-tools-button type="create" value="Get free IP" size="sm" ng-click="get_free_ip(_edit_obj)"></icsw-tools-button>
                        </span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-4 requiredField">
                    Domain tree node<span class="asteriskField">*</span>
                </label>
                <div class="controls col-sm-8">
                    <ui-select ng-model="_edit_obj.domain_tree_node" style="max-width:400px; min-width:240px;" ng-disabled="false">
                        <ui-select-match placeholder="Domain tree node">{{$select.selected.tree_info}}</ui-select-match>
                        <ui-select-choices repeat="value.idx as value in domain_tree_node| props_filter:{tree_info:$select.search}">
                            <div ng-bind-html="value.tree_info | highlight: $select.search"></div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            </div>
        </fieldset>
        <fieldset>
            <legend>Alias settings (will be written without node postfixes)</legend>
            <div class="form-group">
                <label class="control-label col-sm-4">
                    Alias
                </label>
                <div class="controls col-sm-8">
                    <input class="textinput textInput form-control" maxlength="765" name="alias" ng-model="_edit_obj.alias" type="text"/>
                </div>
            </div>
            <div class="form-group">
                <div class="checkbox">
                    <div class="controls col-sm-offset-4 col-sm-7">
                        <label>
                            <input class="checkboxinput checkbox" name="alias_excl" ng-model="_edit_obj.alias_excl" type="checkbox"/>
                            Alias is exclusive
                        </label>
                    </div>
                </div>
            </div>
        </fieldset>
        <div class="form-actions">
            <input type="submit" name="submit" value="" class="btn btn-primary primaryAction" id="submit-id-submit" ng-value="action_string"/>
        </div>
    </form>
</script>
