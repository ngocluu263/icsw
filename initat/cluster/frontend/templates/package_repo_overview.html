{% extends "main.html" %}

{% load i18n compress coffeescript %}

{% block title %}{% trans "Package Install" %}{% endblock %}

{% block content %}

<div ng-app="icsw.package">

{% verbatim %}

<script type="text/ng-template" id="package_repo_head.html">
    <tr>
        <th>Name</th>
        <th>Alias</th>
        <th>Enabled</th>
        <th>AutoRefresh</th>
        <th>GPGcheck</th>   
        <th>publish</th>
        <th>URL</th>   
        <th colspan="3" class="text-center">action</th>   
    </tr>
</script>

<script type="text/ng-template" id="package_repo_row.html">
    <td>{{ obj.name }}</td>
    <td>{{ obj.alias }}</td>
    <td>{{ obj.enabled | yesno1 }}</td>
    <td>{{ obj.autorefresh | yesno1 }}</td>
    <td>{{ obj.gpg_check | yesno1 }}</td>
    <td>{{ obj.publish_to_nodes | yesno1 }}</td>
    <td>{{ obj.url }}</td>
    <td><input type="button" class="btn btn-primary" ng-click="fn.toggle(obj)" value="toggle"/></td>
    <td><input type="button" class="btn btn-danger" ng-click="delete(obj)" value="delete"/></td>
</script>

<script type="text/ng-template" id="package_search_head.html">
    <tr>
        <th>Search string</th>
        <th>User</th>
        <th>State</th>
        <th>repeat</th>
        <th>last search</th>   
        <th colspan="2" class="text-center">action</th>   
    </tr>
</script>

<script type="text/ng-template" id="package_search_row.html">
    <td>{{ obj.last_search_string }}</td>
    <td>{{ obj.user }}</td>
    <td>{{ obj.current_state }}</td>
    <td>{{ obj.num_searches }}</td>
    <td>{{ obj.last_search }}</td>
    <td><input type="button" class="btn btn-primary" ng-show="obj.num_searches == 2" ng-click="fn.toggle(obj)" value="toggle"/></td>
    <td><input type="button" class="btn btn-primary" ng-click="fn.retry(this, obj)" value="retry"/></td>
    <td><input type="button" class="btn btn-danger" ng-click="delete(obj)" value="delete"/></td>
</script>

<tabset>
    <tab heading="Package repositories">
        <div ng-controller="package_repo_base">
            <h3>Repositories ({{entries.length}} entries), <input type="button" value="Rescan" ng-click="fn.rescan(this)"/>, <input type="button" value="Sync to clients" ng-click="fn.sync(this)"/></h3>
            <table class="table table-condensed table-condensed table-hover" style="width:auto;">
                <thead packagerepohead></thead>
                <tbody>
                    <tr><td colspan="9" paginator entries="entries" pag_settings="pagSettings" per_page="10"></td></tr>
                    <tr packagereporow ng-repeat="obj in entries | orderBy:'-identifier':true | paginator:this"></tr>
                </tbody>
            </table>
        </div>
    </tab>
    <tab heading="Package search">
        <div ng-controller="package_search_base">
            <h3>Searches ({{entries.length}} entries)</h3>
            <table class="table table-condensed table-condensed table-hover" style="width:auto;">
                <thead packagesearchhead></thead>
                <tbody>
                    <tr><td colspan="9" paginator entries="entries" pag_settings="pagSettings" per_page="10"></td></tr>
                    <tr packagesearchrow ng-repeat="obj in entries | orderBy:'-name':true | paginator:this"></tr>
                </tbody>
            </table>
        </div>
    </tab>
</tabset>

{% endverbatim %}

</div>

{% endblock %}
