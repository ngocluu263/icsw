{% load i18n %}

<table border="0" width="100%" cellpadding="0" cellspacing="0">
    <tr>
        <td valign="top">
            <div id="sidebar_tree">
            </div>
        </td>
    </tr>
    <tr>
        <td>
            <div id="sidebar_info">
                &nbsp;x
            </div>
        </td>
    </tr>
    <tr>
        <td>
            <div id="sidebar_qlinks">
                &nbsp;y
            </div>
        </td>
    </tr>
</table>

<script type="text/javascript">

function toggle_south(event) {
    my_layout.toggle("south");
}

function toggle_west(event) {
    my_layout.toggle("west");
}

function sidebar_handler() {
    $("#sidebar_tree").dynatree({
        checkbox : true,
        initAjax : {
            url  : "{% url device:get_json_tree %}",
            data : {}
        },
        onLazyRead : function(dtnode) {
            dtnode.appendAjax({
                url  : dtnode.data.url,
                data : {
                    "dg_idx" : dtnode.data.data.dg_idx
                }
            });
        },
<!--        onActivate : function(dtnode) {-->
<!--            console.log("focus");-->
<!--            if (dtnode.data.name == "toggle_sql") {-->
<!--                toggle_south();-->
<!--                dtnode.deactivate();-->
<!--            } else if (dtnode.data.name == "toggle_sidebar") {-->
<!--                toggle_west();-->
<!--                dtnode.deactivate();-->
<!--            } else {;-->
<!--                if (dtnode.data.isLazy) {-->
<!--                } else {                -->
<!--                    if (dtnode.data.url) {-->
<!--                        window.location = dtnode.data.url;-->
<!--                    }-->
<!--                }-->
<!--            }-->
<!--        },-->
<!--        onExpand : function(flag, dtnode) {-->
<!--            console.log("expand");-->
<!--            toggle_expand(dtnode, flag);-->
<!--        },-->
        onSelect : function(flag, dtnode) {
            dtnode.visit(function(cur_node) {
                cur_node.toggleSelect();
            }, false);
        },
        debuglevel : {% if DEBUG %}2{% else %}0{% endif %}
    });
    var my_tree = $("#sidebar_tree").dynatree("getTree");
    $("div#sidebar_tree ul").css({"border" : "none", "margin" : "0px"});
    $("div#sidebar_tree").css({"border" : "1px dotted gray", "background-color" : "#FFFFFF"});
};

</script>
