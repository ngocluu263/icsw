{% extends "main.html" %}

{% load i18n compress coffeescript crispy_forms_tags %}

{% block title %}{% trans "Extended monitoring" %}{% endblock %}

{% block content %}

<div ng-app="icsw.monitoring_extended">

<script type="text/ng-template" id="mon_host_cluster.html">
    {% crispy mon_host_cluster_form mon_host_cluster_form.helper %}
</script>

<script type="text/ng-template" id="mon_service_cluster.html">
    {% crispy mon_service_cluster_form mon_service_cluster_form.helper %}
</script>

<script type="text/ng-template" id="mon_host_dependency.html">
    {% crispy mon_host_dependency_form mon_host_dependency_form.helper %}
</script>

<script type="text/ng-template" id="mon_service_esc_templ.html">
    {% crispy mon_service_esc_templ_form mon_service_esc_templ_form.helper %}
</script>

<script type="text/ng-template" id="mon_device_esc_templ.html">
    {% crispy mon_device_esc_templ_form mon_device_esc_templ_form.helper %}
</script>

{% verbatim %}

<script type="text/ng-template" id="mon_host_cluster_head.html">
    <tr>
        <th>Name</th>   
        <th>Description</th>
        <th>ServiceTemplate</th>
        <th>Main device</th>
        <th>Members</th>
        <th>warn</th>
        <th>error</th>
        <th>Edit</th>
        <th colspan="2" class="text-center">action</th>   
    </tr>
</script>

<script type="text/ng-template" id="mon_host_cluster_row.html">
    <td>{{ obj.name }}</td>
    <td>{{ obj.description }}</td>
    <td>{{ obj.mon_service_templ | array_lookup:this.rest_data.mon_service_templ:'name' }}</td>
    <td>{{ obj.main_device | array_lookup:this.rest_data.device:'name' }}</td>
    <td>{{ obj.devices | resolve_n2m:this.rest_data.device:'name' }}</td>
    <td>{{ obj.warn_value }}</td>
    <td>{{ obj.error_value }}</td>
    <td>{{ obj.user_editable | yesno1 }}</td>
    <td><input type="button" class="btn btn-primary" ng-click="edit($event, obj)" value="modify"/></td>
    <td><input type="button" class="btn btn-danger" ng-show="delete_ok(obj)" ng-click="delete(obj)" value="delete"/></td>
</script>

<script type="text/ng-template" id="mon_service_cluster_head.html">
    <tr>
        <th>Name</th>   
        <th>Description</th>
        <th>ServiceTemplate</th>
        <th>Main device</th>
        <th>Check command</th>
        <th>Members</th>
        <th>warn</th>
        <th>error</th>
        <th>Edit</th>
        <th colspan="2" class="text-center">action</th>   
    </tr>
</script>

<script type="text/ng-template" id="mon_service_cluster_row.html">
    <td>{{ obj.name }}</td>
    <td>{{ obj.description }}</td>
    <td>{{ obj.mon_service_templ | array_lookup:this.rest_data.mon_service_templ:'name' }}</td>
    <td>{{ obj.main_device | array_lookup:this.rest_data.device:'name' }}</td>
    <td>{{ obj.mon_check_command | array_lookup:this.rest_data.mon_check_command:'name' }}</td>
    <td>{{ obj.devices | resolve_n2m:this.rest_data.device:'name' }}</td>
    <td>{{ obj.warn_value }}</td>
    <td>{{ obj.error_value }}</td>
    <td>{{ obj.user_editable | yesno1 }}</td>
    <td><input type="button" class="btn btn-primary" ng-click="edit($event, obj)" value="modify"/></td>
    <td><input type="button" class="btn btn-danger" ng-show="delete_ok(obj)" ng-click="delete(obj)" value="delete"/></td>
</script>

<script type="text/ng-template" id="mon_host_dependency_head.html">
    <tr>
        <th>Name</th>   
        <th>Inherits parent</th>
        <th>Priority</th>
        <th>Period</th>
        <th>up/E</th>
        <th>down/E</th>
        <th>unreach/E</th>
        <th>pend/E</th>
        <th>up/N</th>
        <th>down/N</th>
        <th>unreach/N</th>
        <th>pend/N</th>
        <th colspan="2" class="text-center">action</th>   
    </tr>
</script>

<script type="text/ng-template" id="mon_host_dependency_row.html">
    <td>{{ obj.name }}</td>
    <td>{{ obj.inherits_parent | yesno1 }}</td>
    <td>{{ obj.priority }}</td>
    <td>{{ obj.dependency_period | array_lookup:this.rest_data.mon_period:'name' }}</td>
    <td>{{ obj.efc_up | yesno1 }}</td>
    <td>{{ obj.efc_down | yesno1 }}</td>
    <td>{{ obj.efc_unreachable | yesno1 }}</td>
    <td>{{ obj.efc_pending | yesno1 }}</td>
    <td>{{ obj.nfc_up | yesno1 }}</td>
    <td>{{ obj.nfc_down | yesno1 }}</td>
    <td>{{ obj.nfc_unreachable | yesno1 }}</td>
    <td>{{ obj.nfc_pending | yesno1 }}</td>
    <td><input type="button" class="btn btn-primary" ng-click="edit($event, obj)" value="modify"/></td>
    <td><input type="button" class="btn btn-danger" ng-show="delete_ok(obj)" ng-click="delete(obj)" value="delete"/></td>
</script>

<script type="text/ng-template" id="mon_service_esc_templ_head.html">
    <tr>
        <th>Name</th>   
        <th>First notif</th>
        <th>Last notif</th>
        <th>Interval</th>
        <th>Period</th>
        <th>rec</th>
        <th>crit</th>
        <th>warn</th>
        <th>unkn</th>
        <th>flapping</th>
        <th>planned</th>
        <th colspan="2" class="text-center">action</th>   
    </tr>
</script>

<script type="text/ng-template" id="mon_service_esc_templ_row.html">
    <td>{{ obj.name }}</td>
    <td>{{ obj.first_notification }}</td>
    <td>{{ obj.last_notification }}</td>
    <td>{{ obj.ninterval }}</td>
    <td>{{ obj.esc_period | array_lookup:this.rest_data.mon_period:'name' }}</td>
    <td>{{ obj.nrecovery | yesno1 }}</td>
    <td>{{ obj.ncritical | yesno1 }}</td>
    <td>{{ obj.nwarning | yesno1 }}</td>
    <td>{{ obj.nunknown | yesno1 }}</td>
    <td>{{ obj.nflapping | yesno1 }}</td>
    <td>{{ obj.nplanned_downtime | yesno1 }}</td>
    <td><input type="button" class="btn btn-primary" ng-click="edit($event, obj)" value="modify"/></td>
    <td><input type="button" class="btn btn-danger" ng-show="delete_ok(obj)" ng-click="delete(obj)" value="delete"/></td>
</script>

<script type="text/ng-template" id="mon_device_esc_templ_head.html">
    <tr>
        <th>Name</th>   
        <th>First notif</th>
        <th>Last notif</th>
        <th>Interval</th>
        <th>Period</th>
        <th>ServiceEsc</th>
        <th>rec</th>
        <th>down</th>
        <th>unrch</th>
        <th>flapping</th>
        <th>planned</th>
        <th colspan="2" class="text-center">action</th>   
    </tr>
</script>

<script type="text/ng-template" id="mon_device_esc_templ_row.html">
    <td>{{ obj.name }}</td>
    <td>{{ obj.first_notification }}</td>
    <td>{{ obj.last_notification }}</td>
    <td>{{ obj.ninterval }}</td>
    <td>{{ obj.esc_period | array_lookup:this.rest_data.mon_period:'name' }}</td>
    <td>{{ obj.mon_service_esc_templ | array_lookup:this.rest_data.mon_service_esc_templ:'name' }}</td>
    <td>{{ obj.nrecovery | yesno1 }}</td>
    <td>{{ obj.ndown | yesno1 }}</td>
    <td>{{ obj.nunreachable | yesno1 }}</td>
    <td>{{ obj.nflapping | yesno1 }}</td>
    <td>{{ obj.nplanned_downtime | yesno1 }}</td>
    <td><input type="button" class="btn btn-primary" ng-click="edit($event, obj)" value="modify"/></td>
    <td><input type="button" class="btn btn-danger" ng-show="delete_ok(obj)" ng-click="delete(obj)" value="delete"/></td>
</script>

<tabset>
    <tab heading="Host Clusters">
        <div ng-controller="mon_host_cluster_base">
            <div ng-controller="mon_host_cluster">
                <h2>Host Cluster ({{entries.length}} entries), <input type="button" value="create new" ng-click="create($event)"/></h2>
                <table class="table table-condensed table-condensed table-hover" style="width:auto;">
                    <thead monhostclusterhead></thead>
                    <tbody>
                        <tr><td colspan="9" paginator entries="entries" pag_settings="pagSettings" per_page="5"></td></tr>
                        <tr monhostclusterrow ng-repeat="obj in entries | orderBy:'-name':true | paginator:this"></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </tab>
    <tab heading="Service Clusters">
        <div ng-controller="mon_service_cluster_base">
            <div ng-controller="mon_service_cluster">
                <h2>Service Cluster ({{entries.length}} entries), <input type="button" value="create new" ng-click="create($event)"/></h2>
                <table class="table table-condensed table-condensed table-hover" style="width:auto;">
                    <thead monserviceclusterhead></thead>
                    <tbody>
                        <tr><td colspan="9" paginator entries="entries" pag_settings="pagSettings" per_page="5"></td></tr>
                        <tr monserviceclusterrow ng-repeat="obj in entries | orderBy:'-name':true | paginator:this"></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </tab>
    <tab heading="Host dependencies">
        <div ng-controller="mon_host_dependency_base">
            <div ng-controller="mon_host_dependency">
                <h2>Host dependencies ({{entries.length}} entries), <input type="button" value="create new" ng-click="create($event)"/></h2>
                <table class="table table-condensed table-condensed table-hover" style="width:auto;">
                    <thead monhostdependencyhead></thead>
                    <tbody>
                        <tr><td colspan="9" paginator entries="entries" pag_settings="pagSettings" per_page="5"></td></tr>
                        <tr monhostdependencyrow ng-repeat="obj in entries | orderBy:'-name':true | paginator:this"></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </tab>
    <tab heading="Service escalation">
        <div ng-controller="mon_service_esc_templ_base">
            <div ng-controller="mon_service_esc_templ">
                <h2>Service escalation templates ({{entries.length}} entries), <input type="button" value="create new" ng-click="create($event)"/></h2>
                <table class="table table-condensed table-condensed table-hover" style="width:auto;">
                    <thead monserviceesctemplhead></thead>
                    <tbody>
                        <tr><td colspan="9" paginator entries="entries" pag_settings="pagSettings" per_page="5"></td></tr>
                        <tr monserviceesctemplrow ng-repeat="obj in entries | orderBy:'-name':true | paginator:this"></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </tab>
    <tab heading="Device escalation">
        <div ng-controller="mon_device_esc_templ_base">
            <div ng-controller="mon_device_esc_templ">
                <h2>Device escalation templates ({{entries.length}} entries), <input type="button" value="create new" ng-click="create($event)"/></h2>
                <table class="table table-condensed table-condensed table-hover" style="width:auto;">
                    <thead mondeviceesctemplhead></thead>
                    <tbody>
                        <tr><td colspan="9" paginator entries="entries" pag_settings="pagSettings" per_page="5"></td></tr>
                        <tr mondeviceesctemplrow ng-repeat="obj in entries | orderBy:'-name':true | paginator:this"></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </tab>
</tabset>

{% endverbatim %}

</div>

{% endblock %}
